name: Create Repository
description: 'Creates a new private repository with a master default branch and a README file.'

inputs:
  repository:
    description: "Name of the repository to be created"
    required: true
  pat_token:
    description: "Secret token with permissions to create repositories"
    required: true

runs:
  using: composite
  steps:
    - name: 'Log repository name'
      shell: bash
      run: echo "Creating repository ${{ inputs.repository }}..."

    - name: 'Create new repository using GitHub CLI'
      shell: bash
      env:
        GH_TOKEN: ${{ inputs.pat_token }}
        REPO_NAME: ${{ inputs.repository }}
      run: |
        # Criamos um diretório temporário e navegamos para dentro dele.
        # Isso evita o erro "remote origin already exists", pois executamos o comando
        # em um diretório limpo, que ainda não é um repositório Git.
        mkdir temp_dir
        cd temp_dir

        # Agora, executamos o comando de criação.
        # Usamos o nome completo (OWNER/REPO) para sermos mais explícitos.
        gh repo create ${{ github.repository_owner }}/$REPO_NAME --private --with-readme --default-branch master

        echo "Repositório criado com sucesso!"
        echo "Acesse em: https://github.com/${{ github.repository_owner }}/$REPO_NAME"

    - name: 'Output repository URL'
      shell: bash
      run: echo "Repository URL: https://github.com/${{ github.repository_owner }}/${{ inputs.repository }}"
